---
import DocsLayout from "../../../layouts/DocsLayout.astro";
import CodeBlock from "../../../components/CodeBlock.astro";
import { loadFull } from "../../../utils/template-loader";

const contextMenuCode = loadFull("context-menu");
---

<DocsLayout title="Context Menu" description="A menu that appears on right-click, providing contextual actions for an element" activeComponent="context-menu">
  <div class="space-y-12">

    <header>
      <div class="flex items-center gap-3 mb-4">
        <span class="docs-badge">Commands & Menus</span>
        <span class="docs-badge-primary docs-badge">Alpine.js</span>
      </div>
      <h1 class="docs-hero-title">Context Menu</h1>
      <p class="docs-hero-description mt-3">A menu that appears on right-click, providing contextual actions for an element.</p>
    </header>

    <section>
      <span class="docs-section-label">Preview</span>
      <div class="docs-stage" x-data="mwContextMenu()">
        <div @contextmenu="show($event)"
          class="flex items-center justify-center h-[200px] border-2 border-dashed border-border rounded-marrow text-sm text-muted-foreground cursor-default select-none">
          Right-click here
        </div>

        <!-- Context Menu -->
        <div x-show="open" x-cloak
          @click.away="close()"
          @keydown.escape.window="close()"
          :style="'position: fixed; left: ' + x + 'px; top: ' + y + 'px; z-index: 50;'"
          x-transition:enter="transition ease-out duration-100"
          x-transition:enter-start="opacity-0 scale-95"
          x-transition:enter-end="opacity-100 scale-100"
          x-transition:leave="transition ease-in duration-75"
          x-transition:leave-start="opacity-100 scale-100"
          x-transition:leave-end="opacity-0 scale-95"
          class="mw-popover w-56">
          <button @click="close()" class="mw-menu-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="m9 18 6-6-6-6"/></svg>
            Back
            <span class="ml-auto text-xs text-muted-foreground">Alt+←</span>
          </button>
          <button @click="close()" class="mw-menu-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="m15 18-6-6 6-6"/></svg>
            Forward
            <span class="ml-auto text-xs text-muted-foreground">Alt+→</span>
          </button>
          <button @click="close()" class="mw-menu-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/></svg>
            Reload
            <span class="ml-auto text-xs text-muted-foreground">Ctrl+R</span>
          </button>
          <div class="mw-menu-separator"></div>
          <button @click="close()" class="mw-menu-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
            Save As...
            <span class="ml-auto text-xs text-muted-foreground">Ctrl+S</span>
          </button>
          <button @click="close()" class="mw-menu-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></svg>
            Print
            <span class="ml-auto text-xs text-muted-foreground">Ctrl+P</span>
          </button>
          <div class="mw-menu-separator"></div>
          <button @click="close()" class="mw-menu-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
            View Source
            <span class="ml-auto text-xs text-muted-foreground">Ctrl+U</span>
          </button>
        </div>
      </div>
    </section>

    <section>
      <span class="docs-section-label">In Context</span>
      <div class="docs-stage" x-data="mwContextMenu()">
        <!-- File browser scene -->
        <div class="w-full max-w-md mx-auto">
          <div class="text-sm font-medium text-muted-foreground mb-3 px-1">Project Files</div>
          <div class="border border-border rounded-marrow overflow-hidden divide-y divide-border">
            <div @contextmenu="show($event)" class="flex items-center gap-3 px-4 py-2.5 hover:bg-muted/50 cursor-default select-none">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted-foreground shrink-0" aria-hidden="true"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/></svg>
              <span class="text-sm">index.html</span>
              <span class="ml-auto text-xs text-muted-foreground">4.2 KB</span>
            </div>
            <div @contextmenu="show($event)" class="flex items-center gap-3 px-4 py-2.5 hover:bg-muted/50 cursor-default select-none">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted-foreground shrink-0" aria-hidden="true"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/></svg>
              <span class="text-sm">styles.css</span>
              <span class="ml-auto text-xs text-muted-foreground">1.8 KB</span>
            </div>
            <div @contextmenu="show($event)" class="flex items-center gap-3 px-4 py-2.5 hover:bg-muted/50 cursor-default select-none bg-muted/30">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted-foreground shrink-0" aria-hidden="true"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/></svg>
              <span class="text-sm">app.js</span>
              <span class="ml-auto text-xs text-muted-foreground">6.1 KB</span>
            </div>
            <div @contextmenu="show($event)" class="flex items-center gap-3 px-4 py-2.5 hover:bg-muted/50 cursor-default select-none">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted-foreground shrink-0" aria-hidden="true"><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/></svg>
              <span class="text-sm">assets/</span>
              <span class="ml-auto text-xs text-muted-foreground">3 items</span>
            </div>
          </div>
          <p class="text-xs text-muted-foreground mt-3 text-center">Right-click any file to see the context menu</p>
        </div>

        <!-- Context Menu -->
        <div x-show="open" x-cloak
          @click.away="close()"
          @keydown.escape.window="close()"
          :style="'position: fixed; left: ' + x + 'px; top: ' + y + 'px; z-index: 50;'"
          x-transition:enter="transition ease-out duration-100"
          x-transition:enter-start="opacity-0 scale-95"
          x-transition:enter-end="opacity-100 scale-100"
          x-transition:leave="transition ease-in duration-75"
          x-transition:leave-start="opacity-100 scale-100"
          x-transition:leave-end="opacity-0 scale-95"
          class="mw-popover w-48">
          <button @click="close()" class="mw-menu-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
            Rename
          </button>
          <button @click="close()" class="mw-menu-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
            Copy
            <span class="ml-auto text-xs text-muted-foreground">Ctrl+C</span>
          </button>
          <button @click="close()" class="mw-menu-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/></svg>
            Paste
            <span class="ml-auto text-xs text-muted-foreground">Ctrl+V</span>
          </button>
          <div class="mw-menu-separator"></div>
          <button @click="close()" class="mw-menu-item text-destructive">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
            Delete
            <span class="ml-auto text-xs text-muted-foreground">Del</span>
          </button>
        </div>
      </div>
    </section>

    <section>
      <span class="docs-section-label">Code</span>
      <div class="space-y-4">
        <CodeBlock code={contextMenuCode} lang="html" />
      </div>
    </section>

    <section>
      <span class="docs-section-label">API Reference</span>
      <div class="overflow-x-auto rounded-lg border border-border">
        <table class="docs-api-table">
          <thead>
            <tr>
              <th>Property/Method</th>
              <th>Type</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>open</code></td>
              <td>Boolean</td>
              <td>Controls menu visibility</td>
            </tr>
            <tr>
              <td><code>x</code></td>
              <td>Number</td>
              <td>Horizontal position in pixels</td>
            </tr>
            <tr>
              <td><code>y</code></td>
              <td>Number</td>
              <td>Vertical position in pixels</td>
            </tr>
            <tr>
              <td><code>show(e)</code></td>
              <td>Function</td>
              <td>Opens menu at cursor position (calls e.preventDefault())</td>
            </tr>
            <tr>
              <td><code>close()</code></td>
              <td>Function</td>
              <td>Closes the context menu</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="overflow-x-auto rounded-lg border border-border mt-4">
        <table class="docs-api-table">
          <thead>
            <tr>
              <th>Class</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>mw-popover</code></td>
              <td>Container for the context menu</td>
            </tr>
            <tr>
              <td><code>mw-menu-item</code></td>
              <td>Interactive menu items</td>
            </tr>
            <tr>
              <td><code>mw-menu-separator</code></td>
              <td>Visual divider between menu groups</td>
            </tr>
            <tr>
              <td><code>mw-menu-label</code></td>
              <td>Non-interactive section labels</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section>
      <span class="docs-section-label">Guidelines</span>
      <div class="space-y-4">
        <div class="docs-note">
          <p><strong>Accessibility</strong></p>
          <ul class="list-disc list-inside mt-2 space-y-1">
            <li>Menu closes on <kbd>Escape</kbd> key press</li>
            <li>Menu closes when clicking outside the menu area</li>
            <li>Use semantic <code>&lt;button&gt;</code> elements for all interactive menu items</li>
            <li>Add <code>aria-hidden="true"</code> to decorative icons within menu items</li>
            <li>Consider adding visual feedback for keyboard navigation if implementing arrow key support</li>
          </ul>
        </div>
        <div class="docs-note">
          <p><strong>Best Practices</strong></p>
          <ul class="list-disc list-inside mt-2 space-y-1">
            <li>Bind to the <code>@contextmenu</code> event on the trigger area</li>
            <li>Group related actions with <code>mw-menu-separator</code> dividers</li>
            <li>Include keyboard shortcuts alongside menu items for discoverability</li>
            <li>Keep menu items concise -- use short labels with optional shortcut hints</li>
            <li>Position the menu at the cursor location using the <code>show(e)</code> method</li>
          </ul>
        </div>
      </div>
    </section>

  </div>
</DocsLayout>
