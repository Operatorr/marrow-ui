---
import DocsLayout from "../../../layouts/DocsLayout.astro";
import CodeBlock from "../../../components/CodeBlock.astro";
import { loadFull } from "../../../utils/template-loader";

const toastCode = loadFull("toast");
---

<DocsLayout title="Toast" description="Temporary notification messages that appear at the bottom-right" activeComponent="toast">
  <div class="space-y-12">

    <header>
      <div class="flex items-center gap-3 mb-4">
        <span class="docs-badge">Feedback & Status</span>
        <span class="docs-badge-primary docs-badge">Alpine.js</span>
      </div>
      <h1 class="docs-hero-title">Toast</h1>
      <p class="docs-hero-description mt-3">Brief notification messages that appear temporarily and dismiss automatically. Managed via an Alpine.js global store.</p>
    </header>

    <section>
      <span class="docs-section-label">Preview</span>
      <div class="docs-stage">
        <p class="text-sm text-muted-foreground mb-4">Click a button to trigger a toast notification in the bottom-right corner.</p>
        <div class="flex flex-wrap gap-3">
          <button class="mw-btn mw-btn-primary"
                  @click="$store.toasts.add({ type: 'success', title: 'Success', message: 'Your changes have been saved.' })">
            Success Toast
          </button>
          <button class="mw-btn mw-btn-destructive"
                  @click="$store.toasts.add({ type: 'error', title: 'Error', message: 'Something went wrong. Please try again.' })">
            Error Toast
          </button>
          <button class="mw-btn mw-btn-outline"
                  @click="$store.toasts.add({ type: 'info', title: 'Info', message: 'A new update is available.' })">
            Info Toast
          </button>
        </div>
      </div>
    </section>

    <!-- Toast container (always present on page) -->
    <div x-data
         class="fixed bottom-4 right-4 z-50 flex flex-col gap-2"
         style="pointer-events: none;">
      <template x-for="toast in $store.toasts.items" :key="toast.id">
        <div class="mw-card flex items-start gap-3 min-w-[20rem] max-w-sm shadow-lg"
             style="pointer-events: auto;"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 translate-y-2"
             x-transition:enter-end="opacity-100 translate-y-0"
             x-transition:leave="transition ease-in duration-150"
             x-transition:leave-start="opacity-100 translate-y-0"
             x-transition:leave-end="opacity-0 translate-y-2">
          <!-- Icon -->
          <template x-if="toast.type === 'success'">
            <svg class="w-5 h-5 text-green-500 shrink-0 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M20 6 9 17l-5-5"/></svg>
          </template>
          <template x-if="toast.type === 'error'">
            <svg class="w-5 h-5 text-red-500 shrink-0 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="10"/><line x1="15" x2="9" y1="9" y2="15"/><line x1="9" x2="15" y1="9" y2="15"/></svg>
          </template>
          <template x-if="toast.type === 'info'">
            <svg class="w-5 h-5 text-blue-500 shrink-0 mt-0.5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
          </template>
          <!-- Content -->
          <div class="flex-1 min-w-0">
            <p class="font-medium text-sm" x-text="toast.title"></p>
            <p class="text-sm text-muted-foreground" x-text="toast.message"></p>
          </div>
          <!-- Close -->
          <button @click="$store.toasts.remove(toast.id)" class="shrink-0 text-muted-foreground hover:text-foreground transition-colors" aria-label="Dismiss notification">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
          </button>
        </div>
      </template>
    </div>

    <section>
      <span class="docs-section-label">In Context</span>
      <div class="docs-stage">
        <div class="max-w-md mx-auto space-y-4">
          <div class="rounded-lg border border-border bg-card p-5 space-y-4">
            <h3 class="font-heading text-base font-semibold">Account Settings</h3>
            <div class="space-y-3">
              <div class="space-y-1.5">
                <label class="text-sm font-medium">Display Name</label>
                <input type="text" class="mw-input" value="Jane Cooper" />
              </div>
              <div class="space-y-1.5">
                <label class="text-sm font-medium">Email</label>
                <input type="email" class="mw-input" value="jane@example.com" />
              </div>
            </div>
            <div class="flex justify-end">
              <button class="mw-btn mw-btn-primary"
                      @click="$store.toasts.add({ type: 'success', title: 'Settings saved', message: 'Your account settings have been updated.' })">
                Save Changes
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section>
      <span class="docs-section-label">Code</span>
      <div class="space-y-4">
        <CodeBlock code={toastCode} lang="html" />
      </div>
    </section>

    <section>
      <span class="docs-section-label">API Reference</span>
      <div class="space-y-6">
        <div class="overflow-x-auto rounded-lg border border-border">
          <table class="docs-api-table">
            <thead>
              <tr>
                <th>Property</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr><td><code>type</code></td><td>string</td><td>Visual variant: <code>success</code>, <code>error</code>, or <code>info</code></td></tr>
              <tr><td><code>title</code></td><td>string</td><td>Main heading text of the toast</td></tr>
              <tr><td><code>message</code></td><td>string</td><td>Supporting message text below the title</td></tr>
              <tr><td><code>duration</code></td><td>number</td><td>Auto-dismiss time in milliseconds (default: 5000)</td></tr>
            </tbody>
          </table>
        </div>
        <div class="overflow-x-auto rounded-lg border border-border">
          <table class="docs-api-table">
            <thead>
              <tr>
                <th>Store Method</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr><td><code>$store.toasts.add(toast)</code></td><td>Add a new toast notification</td></tr>
              <tr><td><code>$store.toasts.remove(id)</code></td><td>Manually remove a toast by its ID</td></tr>
              <tr><td><code>$store.toasts.items</code></td><td>Array of all currently active toast objects</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <section>
      <span class="docs-section-label">Guidelines</span>
      <div class="space-y-4">
        <div class="docs-note">
          <p><strong>Accessibility</strong></p>
          <ul class="list-disc list-inside mt-2 space-y-1">
            <li>Dismiss buttons include <code>aria-label="Dismiss notification"</code> for screen readers</li>
            <li>Decorative icons are marked with <code>aria-hidden="true"</code></li>
            <li>Toast content is announced by screen readers as it appears in the DOM</li>
            <li>For critical alerts, consider using longer durations or manual dismissal</li>
          </ul>
        </div>
        <div class="docs-note">
          <p><strong>Best Practices</strong></p>
          <ul class="list-disc list-inside mt-2 space-y-1">
            <li>Place the toast container once at the bottom of your page layout</li>
            <li>Use <code>pointer-events: none</code> on the wrapper to prevent blocking page interactions</li>
            <li>Keep toast messages brief and informative</li>
            <li>Use the appropriate type (<code>success</code>, <code>error</code>, <code>info</code>) to match the message context</li>
            <li>Access the store via <code>$store.toasts.add()</code> from any Alpine.js component, or <code>Alpine.store('toasts').add()</code> from vanilla JS</li>
          </ul>
        </div>
      </div>
    </section>

  </div>
</DocsLayout>
